# 開発系エンジニアのための Docker 絵とき入門 読書メモ

# 1 章

- コンテナ仮想化では OS そのものはホストマシンから借りてきている
- 物理マシンの CPU によっては同じコンテナを起動しても違うコンテナになる
  - これによって動作が違うことがまれにある(apple silicon と intel chip とか)

# 2 章

- 用語整理
  - Docker
    - Docker のシステム全体や仮想化ソフトウェアを指す
  - Docker Engine
    - Docker のデーモン(常駐プロセス)、デーモンが提供する API と CLI クライアントを指す
  - Docker Compose
    - コンテナを複数管理するツール
  - Docker Hub
    - コンテナのイメージを公開しているサービス
- OCI というコンテナの仕様を管理している団体がある
  - Docker 以外の OCI 準拠のサービス間でなら同じコンテナを使える
- プロセスには親子関係が存在する
  - bash が ls を呼び出すなど

# 4 章

- コンテナ内の PID はコンテナそのものの PID と一致する(衝突はしないように Linux のシステムを応用してるらしい)
- イメージは複数のレイヤという tar ファイルからなる
- Dockerfile はイメージにレイヤを追加するファイル
- Docker コマンドには docker から直接呼び出すコマンドとサブコマンドがある
- 覚えておく基礎コマンド
  - docker container run [OPTIONS] IMAGE [COMMAND] [ARG...]
    - コンテナを起動する
  - docker container exec [OPTIONS] CONTAINER COMMAND [ARG...]
    - 起動中のコンテナに命令する
  - docker image build [OPTIONS] PATH|URL|-
    - コンテナイメージを作成する

# 6 章

- コンテナ停止コマンド
  - docker container stop [オプション] CONTAINER [CONTAINER...]
- docker には旧コマンドと新コマンドがある
  - docker ps と docker container ls など

# 7 章

便利オプションが色々載っているのでその都度確認するといいかも

# 8 章

対話モードにするためのオプションについて解説してある

- it で対話モードにできる(i と t がなんなのかは本を参照)

# 9 章

コンテナのポートを公開、マッピングする方法が記載されている

- ポート番号のマッピングは ホストマシンのポート:コンテナのポート　という記法になっている
- マッピングは docker container ls で確認できる
- コマンドは\で改行できる

# 10 章

- d オプションのロングオブションは-detach でバックグラウンドで起動できる

# 11 章

- container logs でログを確認できる
- 出力を消したくない場合は--follow オプション

# 15 章

- コンテナからイメージを作成することもできる
- tar ファイルとして出力すれば git 等で管理も可能
- イメージを tar にすることも可能

# 17 章

- 実際に Dockerfile 作る時は from だけ引っ張ってきて実際に環境構築するコマンド打ちながら作成するのが得策
- &&でコマンドをつなぐとレイヤのキャッシュ削減したりメリットがあるらしいが初級者向けではないので一旦気にしなくていい

# 20 章

- ボリュームを使うことでコンテナに保存しておきたい情報を保管しておける
- Docker にはコンテナ同士で通信するための仮想ネットワークがある

# 22 章

- バインドマウントを使うことでホストマシンのファイルをコンテナに共有できる
